ACMS.Dispatch=function(_context){const context=_context instanceof jQuery?_context.find("*").get(0):_context;if(!context){return}var Config=ACMS.Config;var Dispatch=arguments.callee;new ACMS.Dispatch.ModuleDialog("index");ACMS.Dispatch2(context);$(document).on("drop dragover",function(e){if(e.target.type!=="file"){e.stopPropagation();e.preventDefault()}});Dispatch.Utility(context);if(window!=parent){setTimeout(function(){Dispatch.Utility(context)},1e3)}Dispatch.unloadAlert(context);if(ACMS.Config.layout&&!ACMS.Dispatch.Layout.load){ACMS.Dispatch.Layout()}if(ACMS.Config.eid){Dispatch.revisionIndex(context);Dispatch._revision(context)}$("a.updateTime, .js-time-update",context).each(function(){Dispatch.updatetime(this)});$("a.updateDate, .js-date-update",context).each(function(){Dispatch.updatedate(this)});(function(){const className="js-saving-splash";$(document).on("submit",function(event){if(event.isDefaultPrevented()){return}if(!event.originalEvent){return}const{submitter}=event.originalEvent;if(submitter===null){return}if(!$(submitter).hasClass(className)){return}ACMS.Library.pending.splash(ACMS.i18n("splash.save"));return true})})();var $smartimages=$(Config.SmartPhotoMark,context);if($smartimages.size()){ACMS.Library.SmartPhoto($smartimages.get())}var $modalvideos=$(Config.modalVideoMark,context);if($modalvideos.size()){ACMS.Library.modalVideo($modalvideos.get())}ACMS.Library.highlight(context);$(Config.popupSettingMark,context).each(function(){var $conf=Config.popupSettingConf;$(this).on("click",function(){window.open(this.href,"popup_setting","width="+$conf.width+", height="+$conf.height+", status=no, scrollbars=yes");return false})});$(Config.moduleManagementMark,context).each(function(){$(this).parent(".acms-admin-module-edit").parent().addClass("acms-admin-module-edit-wrapper");$(this).bind("click",function(){var mid=$(this).data("mid"),bid=$(this).data("bid"),edit=isFinite(mid)?"update":"insert";var Dialog=new ACMS.Dispatch.ModuleDialog(edit);Dialog.show(mid,"",bid);return false})});$(Config.dialogBtnMark,context).each(function(){ACMS.Dispatch.Dialog(this)});(function(context){var $moduleForm=$("#js-module_form",context);$moduleForm.on("submit",function(){const removeSplash=ACMS.Library.pending.splash(ACMS.i18n("splash.default"));var $form=$(this),$modalBody=$form.closest(".acms-admin-modal-body"),$modal=$modalBody.closest("#js-module_management"),$iframe=$('iframe[name="js-ajaxPostData"]');$iframe.off().on("load",function(){removeSplash();var res=$iframe.contents(),$res=$(".acms-admin-modal-body",res);$modalBody.html($res.html());Dispatch($modal);$form[0].reset();if(!$(".acms-admin-alert.acms-admin-alert-danger").length&&!Config.layout){if(confirm(Config.moduleManagementReloadMsg)){window.location.reload()}}})})})(context);ACMS.Loaded(function(){$.each(Config.autoHeightRArray.concat({mark:Config.autoHeightRMark,config:Config.autoHeightRConf}),function(){this.config.mark=this.mark;Config.autoHeightRConf=this.config;Dispatch.autoheightR()})});$(Config.fieldgroupSortableMark,context).each(function(){Dispatch.fieldgroupSortable(this)});$.each(Config.dpicArray.concat({mark:Config.dpicMark,config:Config.dpicConfig}),function(){Config.dpicConfig=this.config;$(this.mark,context).each(function(){Dispatch.datepicker(this)})});$.each(Config.accordionArray.concat({mark:Config.accordionMark,config:Config.accordionConfig}),function(){Config.accordionConfig=this.config;$(this.mark,context).each(function(){Dispatch.accordion(this)})});$.each(Config.tabsArray.concat({mark:Config.tabsMark,config:Config.tabsConfig}),function(){Config.tabsConfig=this.config;$(this.mark,context).each(function(){Dispatch.tabs(this)})});$.each(Config.acmsTabsArray.concat({mark:Config.acmsTabsMark,config:Config.acmsTabsConfig}),function(){Dispatch.acmsTabs(this.mark,this.config,context instanceof jQuery?context.get(0):context)});Dispatch.acmsAlertClose(Config.acmsAlertCloseMark,Config.acmsAlertCloseConfig);$.each(Config.acmsAlertCloseArray.concat({mark:Config.acmsAlertCloseMark,config:Config.acmsAlertCloseConfig}),function(){Dispatch.acmsAlertClose(this.mark,this.config)});$.each(Config.faderArray.concat({mark:Config.faderMark,config:Config.faderConfig}),function(){Config.faderConfig=this.config;$(this.mark,context).each(function(){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.fader.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.fader.alternative")});Dispatch.fader(this,Config.faderConfig)})});$(Config.adminFaderMark,context).each(function(){Dispatch.adminFader(this,Config.adminFaderConfig)});if(ACMS.Config.webStorage==="on"&&typeof localStorage!=="undefined"){var key=ACMS.Config.delStorage;if(key){if(ACMS.Config.webStorageCapacity==="limitless"){if(ACMS.Config.webStorageType==="session"){sessionStorage.removeItem(key)}else if(ACMS.Config.webStorageType==="local"){localStorage.removeItem(key)}else{sessionStorage.clear();localStorage.clear()}}}}Dispatch.Postinclude(context);Dispatch.Linkmatchlocation(context);$(Config.validatorFormMark,context).each(function(){Dispatch.validator(this)});$(Config.rolloverImgMark,context).each(function(){Dispatch.rollover(this)});$(Config.scrollToMark,context).each(function(){Dispatch.scrollto(this)});$(Config.zebraMark,context).each(function(){Dispatch.zebra(this)});$(Config.incrementalSearchMark,context).each(function(){Dispatch.incrementalSearch(this)});$(Config.hoverMark,context).each(function(){Dispatch.hover(this)});$(Config.clickSelectionInputTextMark,context).each(function(){Dispatch.selection(this)});$(Config.countupMark,context).each(function(){Dispatch.countup(this)});var innerlinkPtn=new RegExp("("+Config.domains.replace(/,/g,"|")+")(:\\d+)*");$(Config.linkOutsideBlankMark,context).each(function(){if(innerlinkPtn.exec(ACMS.Library.punycodeEncode(this.href))){return true}$(this).attr("target","_blank");if(Config.linkOutsideAppendAttr){$(this).attr("rel",Config.linkOutsideAppendAttr)}});if($("#entryForm",context).length>0){Dispatch.Edit(context)}if(Config.admin||$("[data-acms-admin-frame]").length>0){Dispatch.Admin(context)}if(ACMS.Config.editInplace==="on"){if($(`.js-edit_inplace, ${Config.editInplateTitleMark}`,context).length){ACMS.Load.Dispatch.Edit._inplace(function(){Dispatch.Edit(context)})}}if($(Config.offcanvas.offcanvasMark).length>0){Dispatch.offcanvas(context)}if($(Config.prettyScrollMark,context).length>0){Dispatch.prettyScroll($(Config.prettyScrollMark,context).get(0))}ACMS.dispatchEvent("acmsDispatch")};ACMS.Dispatch.unloadAlert=function(context){ACMS.Dispatch.Utility.unloadAlert(context,ACMS.Config.unloadAlertMark)};ACMS.Dispatch.Linkmatchlocation=function(context){var Config=ACMS.Config;var Linkmatchlocation=arguments.callee;$.each(Config.linkMatchLocationArray.concat({mark:Config.linkMatchLocationMark,type:"part",class:Config.linkMatchLocationClass},{mark:Config.linkMatchLocationFullMark,type:"full",class:Config.linkMatchLocationFullClass},{mark:Config.linkMatchLocationContainMark,type:"contain",class:Config.linkMatchLocationContainClass},{mark:Config.linkMatchLocationBlogMark,type:"blog",class:Config.linkMatchLocationBlogClass},{mark:Config.linkMatchLocationCategoryMark,type:"category",class:Config.linkMatchLocationCategoryClass},{mark:Config.linkMatchLocationEntryMark,type:"entry",class:Config.linkMatchLocationEntryClass}),function(){var mark=this.mark;var type=this.type;var className=this.class;$(mark,context).each(function(){Linkmatchlocation[type](this,className)})})};ACMS.Dispatch.Postinclude=function(context){var Config=ACMS.Config;var Postinclude=arguments.callee;$.each(Config.postIncludeArray.concat({mark:Config.postIncludeOnsubmitMark,type:"submit",method:Config.postIncludeMethod,effect:Config.postIncludeEffect,effectSpeed:Config.postIncludeEffectSpeed},{mark:Config.postIncludeOnreadyMark,type:"ready",method:Config.postIncludeMethod,effect:Config.postIncludeEffect,effectSpeed:Config.postIncludeEffectSpeed,delay:Config.postIncludeReadyDelay},{mark:Config.postIncludeOnBottomMark,type:"bottom",method:Config.postIncludeMethod,effect:Config.postIncludeEffect,effectSpeed:Config.postIncludeEffectSpeed,offset:Config.postIncludeOffset},{mark:Config.postIncludeOnIntervalMark,type:"interval",method:Config.postIncludeMethod,effect:Config.postIncludeEffect,effectSpeed:Config.postIncludeEffectSpeed,interval:Config.postIncludeIntervalTime}),function(){var setting=this;$(this.mark,context).each(function(){Postinclude[setting.type](this,setting)})})};ACMS.Dispatch.scrollto=function(elm){$(elm).click(function(){var hash=elm.hash.slice(1),$target;var offset=$(elm).data("offset");var $setting={};if(!(typeof offset!="number"&&typeof offset!="string")){$setting={offset:offset}}if(!!hash){$target=$('[name="'+hash+'"]'+", "+"#"+hash);ACMS.Library.scrollToElm($target,$setting)}else{ACMS.Library.scrollToElm(null,$setting)}return false})};ACMS.Dispatch.autoheightR=function(){(function(conf){var timer=false,offset=conf.offset,style=conf.style==="height"?"height":"min-height",parent=conf.parent,element=conf.element,list=conf.list,mark=conf.mark;if($(mark).length===0){return}ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.autoheight_r.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.autoheight_r.alternative")});$(window).resize(function(){if(timer!==false){clearTimeout(timer)}timer=setTimeout(function(){var $boxAry=$(mark),currentWidth=0,maxHeight=0,rowAry=[];if(element.length>0){$(element).css(style,"auto")}else{$boxAry.css(style,"auto")}_.each($boxAry,function(v){var $box=$(v),$next=$box.next(),boxWidth=$box.outerWidth(true),tmpHeight=$box.outerHeight(),containerWidth=parent==="parent"?$box.parent().width():$box.closest(parent).width();if(!!list){$next=$box.parent(list).next().find(mark)}if(1&&rowAry.length>0&&containerWidth-(currentWidth+boxWidth)<-5){_.each(rowAry,function(box){if(element.length>0){$(element,box).css(style,maxHeight+offset)}else{$(box).css(style,maxHeight+offset)}});currentWidth=0;maxHeight=0;rowAry=[]}rowAry.push($box);currentWidth+=boxWidth;if(tmpHeight>maxHeight){maxHeight=tmpHeight}if(!$next.hasClass(mark.substring(1))){_.each(rowAry,function(box){if(element.length>0){$(element,box).css(style,maxHeight+offset)}else{$(box).css(style,maxHeight+offset)}});currentWidth=0;maxHeight=0;rowAry=[]}})},200)}).trigger("resize")})(ACMS.Config.autoHeightRConf)};ACMS.Dispatch.datepicker=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.datepicker.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.datepicker.alternative")});(function(config){$(elm).datepicker(config)})(ACMS.Config.dpicConfig)};ACMS.Dispatch.accordion=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.accordion.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.accordion.alternative")});(function(config){$(elm).accordion(config)})(ACMS.Config.accordionConfig)};ACMS.Dispatch.tabs=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.tabs.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.tabs.alternative")});(function(config){$(elm).tabs(config)})(ACMS.Config.tabsConfig)};ACMS.Dispatch.acmsTabs=function(mark,config,context){ACMS.Library.tab(mark,config,context)};ACMS.Dispatch.acmsAlertClose=function(mark,config){$(document).off("click",mark);$(document).on("click",mark,function(){var $alert=$(this).parent(config.target);$alert.remove()})};ACMS.Dispatch.fader=function(elm,config){(function(config){var $head=$(elm);var $body=$(elm.href.replace(/^[^#]+/,""));if($head.hasClass(config.activeClass)){return}$head.addClass(config.activeClass);if("hide"==config.initial){$body.not(config.readyMark).hide();if("none"!=$body.css("display")){$head.addClass(config.activeClass)}}else if("show"==config.initial){$body.show()}$head.on("click",function(event){if("slide"==config.effect){if("none"==$body.css("display")){$head.addClass(config.activeClass);$body.slideDown(config.speed);localStorage.setItem("fader-storage"+$head.attr("href"),"open")}else{$head.removeClass(config.activeClass);$body.slideUp(config.speed);localStorage.setItem("fader-storage"+$head.attr("href"),"close")}}else if("fade"==config.effect){if("none"==$body.css("display")){$body.fadeIn(config.speed);$head.addClass(config.activeClass);localStorage.setItem("fader-storage"+$head.attr("href"),"open")}else{$body.fadeOut(config.speed);$head.removeClass(config.activeClass);localStorage.setItem("fader-storage"+$head.attr("href"),"close")}}event.preventDefault()})})(config)};ACMS.Dispatch.adminFader=function(elm,config){ACMS.Dispatch.fader(elm,config);var $elm=$(elm);if($elm.data("fader-storage")!==undefined||$elm.hasClass("js-fader-storage")){var storage=localStorage.getItem("fader-storage"+$elm.attr("href"));if(storage==="open"){$elm.trigger("click")}}};ACMS.Dispatch.revisionIndex=function(context){$(".js-get_revisions",context).unbind().bind("click",function(){var $revisionBox=$("#js-revision_index");var $backdrop=$(".acms-admin-modal-backdrop");var eid=ACMS.Config.eid;const removeSplash=ACMS.Library.pending.splash(ACMS.i18n("splash.default"));if(!$backdrop.length){$backdrop=$($.parseHTML('<div class="acms-admin-modal-backdrop"></div>')).hide().appendTo("body")}var code='            <div id="acms-admin-revision-index-modal" class="acms-admin-modal out">                <div class="acms-admin-modal-dialog large" role="dialog" aria-modal aria-labelledby="acms-admin-revision-index-modal-title">                    <div class="acms-admin-modal-content">                        <header class="acms-admin-modal-header">                          <h1 id="acms-admin-revision-index-modal-title" class="acms-admin-modal-heading">バージョン一覧</h1>                          <button type="button" class="acms-admin-modal-hide" aria-label="バージョン一覧を閉じる">                            <span class="acms-admin-icon-delete" aria-hidden="true"></span>                          </button>                        </header>                        <div class="acms-admin-modal-body">                        </div>                    </div>                </div>            </div>';if(!$revisionBox.length){$revisionBox=$($.parseHTML(code)).appendTo("body")}else{$revisionBox.empty().remove();$revisionBox=$($.parseHTML(code)).appendTo("body")}var query={hash:Math.random().toString()};if(!!ACMS.Config.aid){query.aid=ACMS.Config.aid}$.ajax({type:"GET",url:ACMS.Library.acmsLink({eid:eid,tpl:"ajax/revision/list.html",Query:query},true),dataType:"html",success:function(res){removeSplash();$raw=$($.parseHTML(res));if($revisionBox.length){$("body").css("overflow","hidden");$revisionBox.find(".acms-admin-modal-body").append($raw);$revisionBox.show();$backdrop.show();setTimeout(function(){$revisionBox.removeClass("out").delay(200).queue(function(){$(this).addClass("in").delay(500).queue(function(){$(this).addClass("display").removeClass("in")}).dequeue()})},1)}ACMS.Dispatch($revisionBox);var closeFn=function(){$("body").css("overflow","");$backdrop.fadeOut();$revisionBox.removeClass("display").addClass("out");setTimeout(function(){$revisionBox.hide()},500);return false};$(".acms-admin-modal-hide",$revisionBox).on("click",closeFn);$revisionBox.on("click",function(event){var click=event.target;if($(click).hasClass("acms-admin-modal")){closeFn()}})}})})};ACMS.Dispatch.updatedate=function(elm){$(elm).on("click",function(e){e.preventDefault();const selector=$(elm).attr("rel")?"#"+$(elm).attr("rel"):$(elm).attr("data-target");const $input=$(selector);$input.val(date());if($input.get(0)){ACMS.Library.triggerEvent($input.get(0),"change")}});function date(){var D=new Date;var Y=D.getFullYear().toString();var m=(D.getMonth()+1).toString();var d=D.getDate().toString();if(1>=m.length)m="0"+m;if(1>=d.length)d="0"+d;return Y+"-"+m+"-"+d}};ACMS.Dispatch.updatetime=function(elm){$(elm).on("click",function(e){e.preventDefault();const selector=$(elm).attr("rel")?"#"+$(elm).attr("rel"):$(elm).attr("data-target");const $input=$(selector);$input.val(time());if($input.get(0)){ACMS.Library.triggerEvent($input.get(0),"change")}});function time(){var d=new Date;var h=d.getHours().toString();var m=d.getMinutes().toString();var s=d.getSeconds().toString();if(1>=h.length)h="0"+h;if(1>=m.length)m="0"+m;if(1>=s.length)s="0"+s;return h+":"+m+":"+s}};ACMS.Dispatch.rollover=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.rollover.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.rollover.alternative")});$(elm).each(function(){var s=elm.src;var i=s.lastIndexOf(".");if(0>i)i=s.length;var o=s.substring(0,i)+ACMS.Config.rolloverImgSuffix+s.substring(i);(new Image).src=o;elm.s=s;elm.o=o;$(elm).hover(function(){this.src=this.o},function(){this.src=this.s})})};ACMS.Dispatch.select2text=function(elm){var self=elm;var aryValue=[];$elm=$(":selected",self);if(!$elm.size()){$elm=$("option:first-child",self)}};ACMS.Dispatch.zebra=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.zebra.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.zebra.alternative")});var tag=elm.tagName.toLowerCase();switch(tag){case"table":$("tr:nth-child(odd)",elm).addClass(ACMS.Config.zebraOddClass);$("tr:nth-child(even)",elm).addClass(ACMS.Config.zebraEvenClass);break;case"ul":case"ol":$("li:nth-child(odd)",elm).addClass(ACMS.Config.zebraOddClass);$("li:nth-child(even)",elm).addClass(ACMS.Config.zebraEvenClass);break;case"dl":$("dt:nth-child(odd)",elm).addClass(ACMS.Config.zebraOddClass);$("dt:nth-child(even)",elm).addClass(ACMS.Config.zebraEvenClass);$("dd:nth-child(odd)",elm).addClass(ACMS.Config.zebraOddClass);$("dd:nth-child(even)",elm).addClass(ACMS.Config.zebraEvenClass);break}};ACMS.Dispatch.incrementalSearch=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.incremental_search.name"),{since:"3.2.0"});var $input=$(ACMS.Config.incrementalSearchBoxMark);var $item=$(ACMS.Config.incrementalSearchElementMark,elm);var placeholder=$input.attr("placeholder");$input.keyup(function(){var search=this.value.split(" ");if(0||search.length===1&&search[0]===placeholder||search.length===2&&search[0]+" "+search[1]===placeholder){return false}for(var i=0;i<$item.length;i++){var itemName=$($item[i]).text();if(itemName.match(new RegExp(search[0],"i"))){$($item[i]).show();if(search.length>1){for(var j=1;j<search.length;j++){if(!itemName.match(new RegExp(search[j],"i"))){$($item[i]).hide()}}}}else{$($item[i]).hide()}}return false});if($input.val()&&$input.val().length){$input.keyup()}};ACMS.Dispatch.hover=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.hover.name"),{since:"3.2.0",alternative:ACMS.i18n("deprecated.feature.hover.alternative")});(function(className){$(elm).hover(function(){$(this).addClass(className)},function(){$(this).removeClass(className)})})(ACMS.Config.hoverClass)};ACMS.Dispatch.selection=function(elm){ACMS.Library.deprecated(ACMS.i18n("deprecated.feature.selection.name"),{since:"3.2.0"});$(elm).on("click",function(){$(this).trigger("select");return false})};ACMS.Dispatch.countup=function(elm){$(elm).bind("keydown change",function(){var $self=$(this),length=Array.from($self.val()).length,max=$self.data("max"),target=$self.data("label-target");$target=$(target),active=ACMS.Config.countupMarkOver;$target.html(length);if(length>max){$target.addClass(active);$self.addClass(active)}else{$target.removeClass(active);$self.removeClass(active)}}).trigger("change")};ACMS.Dispatch.fieldgroupSortable=function(elm){var Config=ACMS.Config;var $sortable=$(elm);var $insert=$sortable.find(Config.fieldgroupSortableItemInsertMark);var $delete=$sortable.find(Config.fieldgroupSortableItemDeleteMark);var $anchor=$sortable.find(Config.fieldgroupSortableItemTemplateMark);var $maxSize=$sortable.find(Config.fieldgroupSortableItemMaxMark).val();var $template=$anchor.clone();if($sortable.hasClass("editing")){return}$sortable.addClass("editing");function number(){var $rows=$sortable.find(Config.fieldgroupSortableItemMark).not(Config.fieldgroupSortableItemTemplateMark);var n=0;$rows.each(function(){$(':input[name$="]"]',this).each(function(){this.name=n+"-"+this.name;if(this.id&&!/\[\d*\]/.exec(this.id)){this.id+="[]"}});$("label",this).each(function(){var labelFor=$(this).attr("for");if(labelFor&&!/\[\d*\]/.exec(labelFor)){$(this).attr("for",labelFor+"[]")}});n++});n=0;$rows.each(function(){$(':input[name$="]"]',this).each(function(){this.name=this.name.replace(/\[\d*\]/,"["+n+"]");if(this.id){this.id=this.id.replace(/\[\d*\]/,"["+n+"]");if($(this).hasClass("hasDatepicker")){$(this).datepicker("destroy");ACMS.Dispatch.datepicker(this)}}});$("label",this).each(function(){var attrFor=$(this).attr("for");if(attrFor){$(this).attr("for",attrFor.replace(/\[\d*\]/,"["+n+"]"))}});n++});n=0;$rows.each(function(){var regex=new RegExp("^"+n+"-");$(':input[name$="]"]',this).each(function(){this.name=this.name.replace(regex,"")});n++})}function addSotableItem(){const $clone=$template[0]instanceof HTMLTemplateElement?$($template.html()):$template.clone();$clone.removeClass(Config.fieldgroupSortableItemTemplateMark.substr(1)).show();$clone.find(Config.fieldgroupSortableItemHandleMark).css("cursor","pointer");$clone.find(Config.fieldgroupSortableItemDeleteMark).on("click",handleDelete);$anchor.before($clone);ACMS.dispatchEvent("acmsAddCustomFieldGroup",$clone.get(0),{item:$clone.get(0)});return $clone}function refreshSotable(){number();ACMS.Dispatch($sortable)}function handleInsert(){if($maxSize==parseInt($maxSize)){var count=$sortable.find(Config.fieldgroupSortableItemMark).size();if(count>$maxSize){alert(Config.fieldgroupSortableItemOverflowMessage1+$maxSize+Config.fieldgroupSortableItemOverflowMessage2);return}}$item=addSotableItem();number();ACMS.Dispatch($item)}function handleDelete(e){var msg=Config.fieldgroupSortableItemDeleteMessage;if(msg.length&&!confirm(msg)){return}var $targetItem=$(e.target).parents(Config.fieldgroupSortableItemMark);$targetItem.remove();refreshSotable()}if($anchor.length>0){$anchor.hide().find(":input").attr("disabled","disabled")}var $sortableItem=$sortable.find(Config.fieldgroupSortableItemMark).not(Config.fieldgroupSortableItemTemplateMark);if($sortableItem.length===0){addSotableItem()}number();$sortableItem.find(":radio[checked]").prop("checked",true);$sortable.find(Config.fieldgroupSortableItemHandleMark).css("cursor","pointer");$sortable.sortable({items:Config.fieldgroupSortableItemMark,handle:Config.fieldgroupSortableItemHandleMark,axis:"y",stop:function(){refreshSotable()}});if($insert.length>0){$insert.on("click",handleInsert)}if($delete.length>0){$delete.on("click",handleDelete)}};ACMS.Dispatch.offcanvas=function(context){var opt=ACMS.Config.offcanvas;var $this=$(opt.offcanvasMark,context);var $body=$("body");var winPos={x:window.scrollX,y:window.scrollY};var focusableElements="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";if($this.hasClass("js-acms-offcanvas-sidebar")){return}$this.addClass("js-acms-offcanvas-sidebar");$this.wrap('<div class="js-acms-offcanvas" />');var $parent=$this.parent(".js-acms-offcanvas");$parent.attr("aria-hidden","true");$body.addClass("js-acms-offcanvas-body");if(opt.openBtnMark){$(opt.openBtnMark).addClass("js-acms-offcanvas-btn").attr("aria-expanded",false).attr("aria-label","Menu").attr("aria-controls",$this.attr("id"))}if(opt.fixedHeaderMark){$(opt.fixedHeaderMark).addClass("js-acms-header-fixed")}$(window).on("resize",_.throttle(function(){if($(".js-acms-offcanvas").hasClass("js-acms-offcanvas-open")){return}if(opt.breakpoint=="all"||opt.breakpoint>=window.innerWidth){$(".js-acms-offcanvas").addClass("js-acms-offcanvas-active");$(".js-acms-offcanvas").attr("aria-hidden",true)}else{$(".js-acms-offcanvas").removeClass("js-acms-offcanvas-active");$(".js-acms-offcanvas").attr("aria-hidden",false)}},opt.throttleTime)).trigger("resize");$(".js-acms-offcanvas-btn").click(function(e){var $this=$(this);var id=$(this).attr("href")||$(this).data("target");var $nav=$(".js-acms-offcanvas-sidebar"+id);var $target=$nav.parent(".js-acms-offcanvas");var $first=$target.find(focusableElements).first();var $last=$target.find(focusableElements).last();$this.attr("aria-expanded",true);$first.off("keydown.acms-offcanvas").on("keydown.acms-offcanvas",function(e){if(e.which===9&&e.shiftKey){e.preventDefault();$last.trigger("focus")}});$last.off("keydown.acms-offcanvas").on("keydown.acms-offcanvas",function(e){if(e.which===9&&!e.shiftKey){e.preventDefault();$first.trigger("focus")}});$last.off("click.acms-offcanvas").on("click.acms-offcanvas",function(){$target.trigger("click");$this.trigger("focus")});if($this.is(opt.openBtnRMark)){$nav.addClass("js-acms-offcanvas-sidebar-right")}else if($this.is(opt.openBtnLMark)){$nav.addClass("js-acms-offcanvas-sidebar-left")}winPos.x=window.scrollX;winPos.y=window.scrollY;var $body=$("body").css({width:window.innerWidth,height:$(window).height()});$target.addClass("js-acms-offcanvas-open").attr("aria-hidden",false);setTimeout(function(){$("html").css("marginTop",-1*window.scrollY);if($nav.hasClass("js-acms-offcanvas-sidebar-right")){$body.addClass("js-acms-offcanvas-body-right")}else{$body.addClass("js-acms-offcanvas-body-left")}$nav.addClass("active");$first.focus()},1);e.preventDefault()});var closeOffcanvas=function(){$(".js-acms-offcanvas-body").addClass("js-acms-offcanvas-body-moving");$(".js-acms-offcanvas-body").removeClass("js-acms-offcanvas-body-right");$(".js-acms-offcanvas-body").removeClass("js-acms-offcanvas-body-left");$(".js-acms-offcanvas-sidebar").removeClass("active");setTimeout(function(){$(".js-acms-offcanvas").removeClass("js-acms-offcanvas-open").attr("aria-hidden",true);$(".js-acms-offcanvas-body").removeClass("js-acms-offcanvas-body-moving");$(".js-acms-offcanvas-btn").attr("aria-expanded",false);$("html").css("marginTop","");$("body").css({width:"",height:""});window.scrollTo(winPos.x,winPos.y)},300)};$(opt.closeBtnMark).on("click touchstart",function(e){closeOffcanvas()});$(".js-acms-offcanvas").on("click touchstart",function(e){if($(e.target).hasClass("js-acms-offcanvas")){e.preventDefault();closeOffcanvas()}});$(".js-acms-offcanvas").on("keydown",function(e){if(e.which===27){e.preventDefault();closeOffcanvas()}})};ACMS.Dispatch.prettyScroll=function(context){var config=Object.assign({},ACMS.Config.prettyScrollConfig);if(context.dataset.offsetTop){config.offsetTop=parseInt(context.dataset.offsetTop,10)}if(context.dataset.offsetBottom){config.offsetBottom=parseInt(context.dataset.offsetBottom,10)}if(context.dataset.breakpoint){config.breakpoint=parseInt(context.dataset.breakpoint,10)}new ACMS.Library.PrettyScroll(context,config)};