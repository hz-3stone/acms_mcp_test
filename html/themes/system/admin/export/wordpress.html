<header>
  <div>
    @include("/admin/topicpath.html")
  </div>
  <div>
    <h1 class="acms-admin-admin-title js-dialog-title">
      <!--T-->WordPress（WXR形式）エクスポート
      <!--/T-->
    </h1>
  </div>
</header>

<!-- BEGIN_MODULE Touch_SessionWithAdministration -->
<div class="acms-admin-panel">
  <div class="acms-admin-panel-header">
    <p class="acms-admin-panel-title">
      <!--T-->WXR形式でエクスポートします<!--/T-->
    </p>
  </div>
  <div class="acms-admin-panel-body">
    <ul>
      <li>
        <!--T-->エントリー、カテゴリー、ユーザー情報をエクスポートします<!--/T-->
      </li>
      <li>
        <!--T-->エントリーのカスタムフィールドもエクスポートされますが、カスタムフィールドグループは各要素の配列となってエクスポートされます。<!--/T-->
      </li>
      <li>
        <!--T-->ユニットのメイン画像が、サムネイルとして書きだされます。<!--/T-->
      </li>
    </ul>
  </div>
</div>

<!-- BEGIN_MODULE Admin_Messages -->
<p class="acms-admin-alert acms-admin-alert-icon acms-admin-alert-info">
  <span class="acms-admin-icon acms-admin-icon-news acms-admin-alert-icon-before" aria-hidden="true"></span>
  {message}
</p>
<!-- END_MODULE Admin_Messages -->

<!-- BEGIN_MODULE Admin_Errors -->
<div class="acms-admin-alert acms-admin-alert-danger acms-admin-alert-icon">
  <span class="acms-admin-alert-icon-before acms-admin-icon-attention"></span>
  {error}
</div>
<!-- END_MODULE Admin_Errors -->


<!-- BEGIN_MODULE Admin_Export_WordPress -->
<!-- BEGIN_IF [{processing}/eq/1]-->
<h2 class="acms-admin-admin-title2"><!--T-->エクスポート状況<!--/T--></h2>
<div id="js-background-wxr-export" data-type="export_wxr">
  <div class="js-progress acms-admin-progress acms-admin-progress-striped acms-admin-active" style="display: none;">
    <div class="acms-admin-progress-bar">
      <span></span>
    </div>
  </div>
  <script type="text/template" class="js-processing-template">
    <% if (!processing && success) { %>
    <p class="acms-admin-alert acms-admin-alert-info">
      <!--T-->エクスポートが完了しました。<!--/T-->
    </p>
    <% } else if (!processing && error) { %>
    <p class="acms-admin-alert acms-admin-alert-warning">
      <!--T-->エクスポートに失敗しました。<!--/T-->
    </p>
    <% } %>

    <ul>
      <% _.each(processList, function(item) { %>
      <% if (item.status === 'ng') { %>
      <li class="acms-admin-text-danger">[Error] <%= item.message %></li>
      <% } else { %>
      <li><%= item.message %></li>
      <% } %>
      <% }) %>
    </ul>
  </script>
  <div class="js-processing-box"></div>
</div>
<!-- ELSE -->
<form action="" method="post" enctype="multipart/form-data" class="acms-admin-form acms-admin-margin-bottom-large">
  <h2 class="acms-admin-admin-title2">
    <!--T-->エントリーデータのエクスポート<!--/T-->
  </h2>
  <table class="adminTable acms-admin-table-admin-edit">
    <tr>
      <th>
        <!--T-->エクスポートブログ<!--/T-->
      </th>
      <td>
        %{BLOG_NAME}（<!--T-->現在のブログ<!--/T-->）
      </td>
    </tr>
    <tr>
      <th><!--T-->対象ブログ<!--/T--></th>
      <td>
        <div class="acms-admin-form-checkbox">
          <input type="checkbox" name="include_child_blogs[]" {include_child_blogs:checked#on} id="input-checkbox-include_child_blogs-on" value="on" />
          <label for="input-checkbox-include_child_blogs-on">
            <i class="acms-admin-ico-checkbox"></i><!--T-->子ブログも対象にする<!--/T--></label>
        </div>
        <input type="hidden" name="field[]" value="include_child_blogs" />
      </td>
    </tr>
    <tr>
      <th>
        <!--T-->エクスポート<!--/T-->
      </th>
      <td>
        <button
          class="acms-admin-btn-admin acms-admin-btn-admin-primary acms-admin-btn-admin-save"
          type="submit"
          name="ACMS_POST_Export_Wordpress"
          onclick="return confirm('<!--T-->エクスポートを実行します。よろしいですか？<!--/T-->');"
        >
          <!--T-->エクスポートを実行する<!--/T-->
        </button>
      </td>
    </tr>
  </table>
</form>
<!-- END_IF -->

<!-- BEGIN_MODULE Admin_Backup_ArchiveZipList -->
<form action="" method="post" enctype="multipart/form-data" class="acms-admin-form acms-admin-margin-bottom-large">
  <h2 class="acms-admin-admin-title2">
    <!--T-->エクスポートデータのダウンロード<!--/T-->
  </h2>

  <table class="adminTable acms-admin-table-admin-edit">
    <tr>
      <th><!--T-->ファイルを選択<!--/T--></th>
      <td>
        <!-- BEGIN_IF [\{processing\}/neq/1]-->
        <!-- BEGIN wxr:veil -->
        <div class="acms-admin-margin-bottom-medium">
          <select name="export_file" class="js-select2 acms-admin-form-width-half"><!-- BEGIN wxr:loop -->
            <option value="{xml}">{xml}</option><!-- END wxr:loop -->
          </select>

          <input
            type="submit"
            name="ACMS_POST_Export_Download"
            value="<!--T-->ダウンロード<!--/T-->"
            class="acms-admin-btn-admin acms-admin-btn-admin-primary"
          />

          <input
            type="submit"
            name="ACMS_POST_Export_Remove"
            value="<!--T-->削除<!--/T-->"
            onclick="return confirm('<!--T-->選択したエクスポートデータを削除します。本当によろしいですか？<!--/T-->');"
            class="acms-admin-btn-admin acms-admin-btn-admin-danger"
          />
        </div>
        <!-- END wxr:veil -->
        <!-- END_IF -->
        <p class="acms-admin-alert acms-admin-alert-warning">
          <!--T-->エクスポート直後はリストに出てこないため、ブラウザをリロードをしてください。<!--/T-->
        </p>
      </td>
    </tr>
  </table>
</form>
<!-- END_MODULE Admin_Backup_ArchiveZipList -->
<!-- END_MODULE Admin_Export_WordPress -->
<!-- END_MODULE Touch_SessionWithAdministration -->
